# 리스너

- 모든 엔티티를 대상으로 언제 어떤 사용자가 삭제를 요청했는지 모두 로그로 남겨야 하는 요구사항이 있다고 가정하자.<br>
이때 애플리케이션 삭제 로직을 하나씩 찾아서 로그를 남기는 것은 너무 비효율 적이다.<br>
JPA 리스너 기능을 사용하면 엔티티의 생명주기에 따른 이벤트를 처리할 수 있다.

1. PostLoad : 엔티티가 영속성 컨텍스트에 조회된 직후 또는 refresh 를 호추한 후(2차 캐시에 저장되어 있어도 호출된다.)

2. PrePersist : persist() 메소드를 호출해서 엔티티를 영속성 컨텍스트에 관리 하지 직전에 호출된다.<br>
식별자 생성 전략을 사용한 경우 엔티티에 식별자는 아직 존재하지 않는다. 새로운 인스턴스를 merge 할 때도 수행된다.

3. PreUpdate : flush 나 commit 을 호출해서 엔티티를 데이터베이스에 수정하기 직전에 수행된다.

4. PreRemove : remove() 메소드를 호출해서 엔티티를 영속적으로 컨텍스트에서 삭제하기 직전에 호출 된다.<br>
또한 삭제 명령어로 영속성 전이가 일어날 때도 호출 된다. orphanRemoval 에 대해서는 flush 나 commit 시에 호출 된다.

5. PostPersist : flush 나 commit 을 호출해서 엔티티를 데이터베이스에 저장한 직후에 호출 된다. 식별자가 항상 존재한다.<br>
참고로 식별자 생성 전략이 IDENTITY 면 식별자를 생성하기 위해 persist() 를 호출하면서 데이터 베이스에 해당 엔티티를 저장하므로<br>
이때는 persist() 를 호출한 직후에 바로 PostPersist 가 호출 된다.

6. PostUpdate : flush 나 commit 을 호출해서 엔티티를 데이터베이스에 수정한 직후에 호출 된다.

7. PostRemove : flush 나 commit 을 호출해서 엔티티를 데이터베이스에 삭제한 직후에 호출 된다.